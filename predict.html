<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Make Predictions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 40px auto; max-width: 900px; padding: 16px; color:#111; }
    .row { display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px; border-top:1px solid #eee; }
    .box { border:1px solid #ddd; border-radius: 12px; overflow:hidden; }
    .top { display:flex; align-items:center; justify-content:space-between; padding:12px; gap:12px; flex-wrap: wrap; }
    input[type="number"] { width: 60px; padding: 8px; text-align:center; border:1px solid #ccc; border-radius:8px; }
    input[type="text"] { padding: 8px; border:1px solid #ccc; border-radius:8px; }
    .btn { padding:8px 12px; border:1px solid #333; border-radius:8px; background:#111; color:#fff; cursor:pointer; }
    .btn.ghost { background:#fff; color:#111; }
    .btn:disabled { opacity:0.5; cursor:not-allowed; }
    .muted { color:#666; font-size:12px; }
    .pill { background:#f3f4f6; border-radius:12px; padding:4px 8px; font-size:12px; color:#374151; }
    a { color:#111; }
  </style>
</head>
<body>
  <a href="index.html">‚Üê Back</a>
  <h1>Make Predictions</h1>
  <p class="muted">This version saves on your device, and (optionally) to the cloud if you enter your name.</p>

  <div id="wrap" class="box">
    <div class="top">
      <div><b>This weekend</b> <span id="weekLabel" class="pill"></span></div>
      <div style="display:flex; align-items:center; gap:8px">
        <label for="who">Your name:</label>
        <input id="who" type="text" placeholder="e.g. Mark" />
        <button id="saveCloud" class="btn">Save all to cloud</button>
        <button id="clearBtn" class="btn ghost">Clear my device</button>
      </div>
    </div>
    <div id="list"></div>
  </div>

  <!-- Supabase browser SDK (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
  window.addEventListener('DOMContentLoaded', () => {
    // üîë Your Supabase project settings
    const SUPABASE_URL = "https://xxqykjiuowunwdiskhnk.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh4cXlraml1b3d1bndkaXNraG5rIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3MjY0MTcsImV4cCI6MjA3MjMwMjQxN30.jdmL2nU07BwoSHxaGavnymhBpxA2HYnPOzNerR_Qa6I";

    // Create a Supabase client from the CDN global "supabase"
    function getClient() {
      return supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    }

    // --- Helpers: next Saturday/Sunday & mock fixtures
    function getWeekend() {
      const now = new Date();
      const sat = new Date(now);
      sat.setDate(sat.getDate() + ((6 - sat.getDay() + 7) % 7)); // next Saturday
      const sun = new Date(sat); sun.setDate(sat.getDate() + 1);
      const fmt = (d) => d.toLocaleDateString(undefined, { weekday:'short', day:'2-digit', month:'short' });
      return { sat, sun, label: `${fmt(sat)} & ${fmt(sun)}` };
    }
    function at(day, h, m) { const d = new Date(day); d.setHours(h, m, 0, 0); return d.toISOString(); }
    function fixtures() {
      const { sat, sun } = getWeekend();
      const weekId = `${sat.getFullYear()}-demo`;
      return [
        { id: `${weekId}-1`, kickoff: at(sat,12,30), home:'Arsenal',  away:'Newcastle' },
        { id: `${weekId}-2`, kickoff: at(sat,15,0),  home:'Man City', away:'Everton'   },
        { id: `${weekId}-3`, kickoff: at(sun,16,30), home:'Chelsea',  away:'Spurs'     },
      ];
    }
    const LOCKED = iso => new Date() >= new Date(iso);

    // --- Local storage helpers
    const KEY = 'wknd-preds';
    function loadPreds(){ try{ return JSON.parse(localStorage.getItem(KEY) || '{}'); }catch{ return {}; } }
    function savePreds(p){ localStorage.setItem(KEY, JSON.stringify(p)); }

    // Elements (with guards)
    const weekLabelEl = document.getElementById('weekLabel');
    const list = document.getElementById('list');
    const whoEl = document.getElementById('who');
    const clearBtn = document.getElementById('clearBtn');
    const saveCloudBtn = document.getElementById('saveCloud');

    if (!weekLabelEl || !list || !whoEl || !clearBtn || !saveCloudBtn) {
      console.error('One or more elements not found. Check IDs in HTML.');
      return;
    }

    const fxs = fixtures();
    const preds = loadPreds();
    weekLabelEl.textContent = getWeekend().label;

    // Remember the last name used locally
    const NAME_KEY = 'wknd-name';
    try { const last = localStorage.getItem(NAME_KEY); if_






