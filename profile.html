<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Profile â€¢ Weekend Predictor</title>

  <link rel="stylesheet" href="brand.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
  <script src="supabase-config.js?v=3"></script>

  <style>
    :root{
      --text:#e9eefc; --muted:#9aa7c7; --border:rgba(255,255,255,.08);
      --accent:#8ab3ff; --bg1:rgba(11,18,32,.85); --bg2:rgba(14,22,48,.85);
    }
    html,body{height:100%;margin:0;}
    body{
      color:var(--text);
      font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Inter,"Helvetica Neue",Arial,system-ui,sans-serif;
      background:linear-gradient(180deg,var(--bg1),var(--bg2)),url("prem-hero.jpg") center/cover no-repeat fixed;
      display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;
      min-height:100vh;padding:20px;
    }
    .card{
      width:100%;max-width:420px;background:rgba(255,255,255,.05);
      border:1px solid var(--border);backdrop-filter:blur(10px);
      border-radius:20px;padding:28px 24px;box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    h1{margin:0 0 12px;font-weight:800;}
    .muted{color:var(--muted);margin-bottom:12px;}
    .info{margin-top:20px;text-align:left;}
    .info p{margin:8px 0;}
    a.btn{display:inline-block;margin-top:20px;padding:12px 18px;border-radius:10px;border:1px solid var(--border);text-decoration:none;color:var(--text);}
    a.btn:hover{border-color:#2a3a5a;}
  </style>
</head>
<body>
  <main class="card">
    <h1>My Profile</h1>
    <p class="muted" id="status">Loading...</p>
    <div class="info" id="profile-info" style="display:none;">
      <p><strong>Email:</strong> <span id="email"></span></p>
      <p><strong>Username:</strong> <span id="username"></span></p>
      <p><strong>Total Points:</strong> <span id="points"></span></p>
    </div>
    <a href="leaderboard.html" class="btn">Leaderboard</a>
    <a href="index.html" class="btn">Home</a>
  </main>

  <script>
    (async () => {
      await supabase.auth.getSession();
      const { data: { session } } = await supabase.auth.getSession();
      const status = document.getElementById('status');
      const info = document.getElementById('profile-info');

      if (!session) {
        status.textContent = 'Not signed in. Redirecting...';
        setTimeout(() => window.location.replace('login.html'), 1200);
        return;
      }

      const user = session.user;
      document.getElementById('email').textContent = user.email || 'Unknown';
      status.textContent = 'Welcome!';
      info.style.display = 'block';

      // Optional: load extra profile data from your table
      try {
        const { data, error } = await supabase.from('profiles').select('*').eq('id', user.id).single();
        if (error) throw error;
        document.getElementById('username').textContent = data.username || 'N/A';
        document.getElementById('points').textContent = data.points || 0;
      } catch (err) {
        console.warn('Profile data not found, showing defaults.');
        document.getElementById('username').textContent = 'N/A';
        document.getElementById('points').textContent = 0;
      }
    })();
  </script>
</body>
</html>
