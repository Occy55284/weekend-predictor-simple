<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>My Picks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="assets/logo-burst.png" />
  <link rel="stylesheet" href="brand.css" />
</head>
<body>
  <div class="container">
    <div class="header">
      <h1><img class="brand-logo" src="assets/logo-burst.png" alt="">My Picks</h1>
      <p class="muted">Read-only view of your submitted predictions.</p>
    </div>

    <div class="card">
      <div id="fixtures"></div>
      <a class="btn btn-dark" href="index.html">‚Üê Home</a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-config.js"></script>
  <script>
    const client = supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY);
    const fixturesDiv=document.getElementById('fixtures');

    async function load(){
      const { data: ur } = await client.auth.getUser();
      const u=ur?.user; if(!u){ location.replace('login.html'); return; }
      const { data: feats } = await client.from('fixtures').select('*').eq('featured',true).order('utc_date');
      if(!feats?.length){ fixturesDiv.textContent='No fixtures yet'; return; }
      const ids=feats.map(f=>f.id);
      const { data: preds } = await client.from('predictions').select('*').eq('user_id',u.id).in('fixture_id',ids);
      const map={}; preds.forEach(p=>map[p.fixture_id]=p);
      fixturesDiv.innerHTML='<table><tr><th>Date</th><th>Home</th><th>Score</th><th>Away</th></tr>'+
        feats.map(f=>{
          const p=map[f.id]||{};
          const d=new Date(f.utc_date).toLocaleString(undefined,{weekday:'short',day:'2-digit',hour:'2-digit',minute:'2-digit'});
          return `<tr>
            <td>${d}</td>
            <td>${f.home_team}</td>
            <td>${p.home_score??'-'} : ${p.away_score??'-'}</td>
            <td>${f.away_team}</td>
          </tr>`;
        }).join('')+'</table>';
    }

    load();
  </script>
</body>
</html>

