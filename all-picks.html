<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>All Weekly Picks • Weekend Predictor</title>
  <link rel="stylesheet" href="brand.css?v=96" />

  <style>
    .page-header-title { margin-bottom: 4px; }
    .controls-row {
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-top:4px;
    }
    .controls-row .muted {
      font-size:0.85rem;
    }
    .pill-select {
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.7);
      background:rgba(15,23,42,0.96);
      color:#e5e7eb;
      padding:4px 10px;
      font-size:0.85rem;
    }
    .subtext {
      font-size:0.8rem;
      color:#9ca3af;
      margin-top:6px;
    }
    .matrix-wrapper {
      margin-top:12px;
      max-width:100%;
      overflow:auto;
    }
    .matrix {
      width:100%;
      border-collapse:collapse;
      font-size:0.85rem;
      min-width:620px;
    }
    .matrix th,
    .matrix td {
      padding:6px 6px;
      border-bottom:1px solid rgba(51,65,85,0.8);
      text-align:center;
      white-space:nowrap;
    }
    .matrix thead th {
      position:sticky;
      top:0;
      background:rgba(15,23,42,0.98);
      z-index:1;
      text-transform:uppercase;
      letter-spacing:.08em;
      font-size:0.75rem;
      color:#9ca3af;
    }
    .matrix tbody tr:nth-child(even) {
      background:rgba(15,23,42,0.7);
    }
    .matrix tbody tr:nth-child(odd) {
      background:rgba(15,23,42,0.5);
    }
    .matrix th.fixture-col {
      text-align:left;
      min-width:180px;
      max-width:260px;
    }
    .fixture-main {
      font-weight:600;
      color:#e5e7eb;
      display:block;
    }
    .fixture-tag {
      font-size:0.7rem;
      text-transform:uppercase;
      letter-spacing:.06em;
      color:#9ca3af;
      display:block;
      margin-top:1px;
    }
    .player-header {
      font-weight:600;
      color:#e5e7eb;
      font-size:0.8rem;
    }
    .pick-cell {
      font-weight:500;
      color:#e5e7eb;
      font-size:0.85rem;
    }
    .pick-missing {
      color:#64748b;
      font-style:italic;
    }
    .badge-pill {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:1px 6px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.7);
      font-size:0.7rem;
      color:#e5e7eb;
      background:rgba(15,23,42,0.96);
      margin-left:4px;
    }
    .badge-locked {
      border-color:#22c55e;
      color:#22c55e;
    }
  </style>
</head>
<body class="bg-hero">
  <div class="page-shell">

    <!-- NAV -->
    <header class="top-nav">
      <div class="top-nav-left">
        <div class="nav-logo">
          <img src="assets/brand-logo.png" alt="Weekend Predictor logo" />
        </div>
        <div class="nav-text-group">
          <div class="nav-title">Weekend Predictor</div>
          <div class="nav-subtitle">All players’ picks for this week</div>
        </div>
      </div>
      <nav class="top-nav-links">
        <a href="index.html">Home</a>
        <a href="predict.html">Predict</a>
        <a href="leaderboard.html">Leaderboard</a>
        <a href="my-picks.html">My Picks</a>
        <a href="all-picks.html" class="active">All Picks</a>
        <a href="profile.html">Profile</a>
        <a href="admin.html" id="navAdmin" style="display:none">Admin</a>
        <a href="login.html" id="navLogout">Logout</a>
      </nav>
    </header>

    <main class="main-layout">
      <!-- MAIN PANEL -->
      <section class="panel panel-main wide">
        <div class="panel-inner">
          <h1 class="page-header-title">All weekly picks</h1>

          <div class="controls-row">
            <p class="muted" id="weekLabel">Current gameweek (Mon–Sun)</p>

            <div style="display:flex;gap:8px;align-items:center;">
              <span class="muted" style="font-size:0.8rem;">Week</span>
              <select class="pill-select" disabled>
                <option>Current week</option>
              </select>
            </div>
          </div>

          <p class="subtext">
            Fixtures down the left • each player in a column • cells show their predicted score.
          </p>

          <!-- MATRIX MOCKUP -->
          <div class="matrix-wrapper">
            <table class="matrix">
              <thead>
                <tr>
                  <th class="fixture-col">Fixture</th>
                  <th><span class="player-header">Occy</span></th>
                  <th><span class="player-header">Mark</span></th>
                  <th><span class="player-header">Serdi</span></th>
                  <th><span class="player-header">Jono</span></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th class="fixture-col">
                    <span class="fixture-main">Arsenal vs Spurs</span>
                    <span class="fixture-tag">Sat 15:00</span>
                  </th>
                  <td class="pick-cell">2–1 <span class="badge-pill badge-locked">L</span></td>
                  <td class="pick-cell">2–0 <span class="badge-pill badge-locked">L</span></td>
                  <td class="pick-cell">1–1</td>
                  <td class="pick-cell pick-missing">—</td>
                </tr>
                <tr>
                  <th class="fixture-col">
                    <span class="fixture-main">Liverpool vs Chelsea</span>
                    <span class="fixture-tag">Sat 17:30</span>
                  </th>
                  <td class="pick-cell">3–2 <span class="badge-pill badge-locked">L</span></td>
                  <td class="pick-cell">2–1</td>
                  <td class="pick-cell">2–0</td>
                  <td class="pick-cell pick-missing">—</td>
                </tr>
                <tr>
                  <th class="fixture-col">
                    <span class="fixture-main">Man City vs Newcastle</span>
                    <span class="fixture-tag">Sun 16:30</span>
                  </th>
                  <td class="pick-cell">2–0</td>
                  <td class="pick-cell">3–1</td>
                  <td class="pick-cell">2–1</td>
                  <td class="pick-cell">1–1</td>
                </tr>
                <tr>
                  <th class="fixture-col">
                    <span class="fixture-main">Brighton vs West Ham</span>
                    <span class="fixture-tag">Sun 14:00</span>
                  </th>
                  <td class="pick-cell pick-missing">—</td>
                  <td class="pick-cell">1–0</td>
                  <td class="pick-cell">1–1</td>
                  <td class="pick-cell">0–2</td>
                </tr>
              </tbody>
            </table>
          </div>

          <p class="subtext" style="margin-top:10px;">
            Later we’ll swap the mock data for live data from Supabase (fixtures × players for the current week).
          </p>
        </div>
      </section>

      <!-- SIDE PANEL -->
      <aside class="panel panel-side">
        <div class="panel-inner">
          <h2>Planned behaviour</h2>
          <ul class="bullet-list">
            <li>Rows = featured fixtures for the current week.</li>
            <li>Columns = every player who has picks that week.</li>
            <li>Cell = predicted score (home–away).</li>
            <li>Small “L” badge if the player has locked their week.</li>
          </ul>
        </div>
      </aside>
    </main>
  </div>

  <!-- Small script: set week label + admin/logout wiring -->
  <script type="module">
    import { supabase } from './supabase-config.js';

    const weekLabel = document.getElementById('weekLabel');
    const navAdmin  = document.getElementById('navAdmin');
    const navLogout = document.getElementById('navLogout');

    function startOfWeek(d=new Date()){
      const x = new Date(d);
      const day = x.getDay() === 0 ? 7 : x.getDay();
      x.setHours(0,0,0,0);
      x.setDate(x.getDate() - (day - 1));
      return x;
    }
    function addDays(d,n){ const x = new Date(d); x.setDate(x.getDate()+n); return x; }

    const ws = startOfWeek();
    const we = addDays(ws,6);
    weekLabel.textContent = `Current week: ${ws.toLocaleDateString()} – ${we.toLocaleDateString()} (Mon–Sun)`;

    (async () => {
      const { data: { session } } = await supabase.auth.getSession();
      const user = session?.user;
      if (!user) return;

      try {
        const { data } = await supabase
          .from('profiles')
          .select('is_admin')
          .eq('id', user.id)
          .maybeSingle();
        if (data?.is_admin) navAdmin.style.display = '';
      } catch {}

      navLogout?.addEventListener('click', async (e) => {
        e.preventDefault();
        try { await supabase.auth.signOut(); } catch {}
        window.location.replace('login.html');
      });
    })();
  </script>
</body>
</html>
